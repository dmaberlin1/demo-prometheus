
#docker-compose up --build
#docker-compose up --d


ТЗ :
- данные, которые прометеус собирает в базе хранить
- в ПГ тайм сириес активировать и туда все пхать. (timescaleDB)
- Представь что тебе надо функционал по построению кривых на основе баланса пользователя и его статистики побед и поражений.
  -вначале в графане кривую выводить, потом анализировать кривую, потом график графаны встроим в свой html




## по шагам

- подключить timescaleDB
- подключить конектор postgresql и prometheus
- настроить чтобы прометеус клал в тайм сириес бд

# process
- сначала в микрометр, потом его себе пишет в файл прометеус, и оттуда берёт графана
- мне нужно чтобы прометеус писал не в файл в а постгрес с помощью extension timescaleDB для постгрес
- как раз тут постгрес подходит, надо кверять будет данные и агрегации делать на лету













###
давай теперь усложним сервис. Поучимся расширять код, тестировать и менять структуру))
Добавь модуль, которій смотрит на каждое обновление метрики из прометеуса
Установи Threshold .
Пусть твой сервис проводит євалюейшн
Если трешхолд достиг 99-110% - формирует ред алерт
Вся таблица алертов:
75-80% - грин алерт
80-98% - желтій
99-110% - ред
111+% - блек

Алерт єто кастомній обьект. В него всунь инфу чтоб біло понятно что и когда произошло


Сделай еще одну аппку, которая будет принимать твой алерт по ресту и пока что просто логгировать и ложить в отдельную базу. можешь использовать тот же инстанс постгреса, но дуругую базу


и тебе понадобится сервис, которій заполняет твою табличку фейковіми данніми. Сделай чтоб он срабатівал когда по ресту дернули его и останавливается так же.
Дл генерации советую использовать либку Java Faker


ThresholdEvaluationService покрыть тестами
Алерт должен сработать один раз при пересечении метрики "снизу вверх". Если состояние улучшилось то алерт более низкого уровня не должен слаться. Если снова ухудшилось - пошлется еще раз

можешь у Прометеуса тоже спрашивать исторические данніе чтоб не городить свою time series логику


### План

Алерты будут по наполнению таблицы employee,

75-80% (Green Alert): Если метрика находится в этом диапазоне, система генерирует зеленый алерт, указывающий на то, что показатели находятся в допустимом диапазоне, но следует обратить внимание.

80-98% (Yellow Alert): Желтый алерт означает, что метрика находится в диапазоне, где требуется повышенное внимание, так как значения близки к критическим.

99-110% (Red Alert): Красный алерт указывает на критическое состояние, где значения метрики превышают допустимые пределы, что требует немедленного вмешательства.

111% и выше (Black Alert): Черный алерт сигнализирует о чрезвычайно критическом состоянии, что может указывать на серьёзную проблему в системе, требующую немедленных действий.

### Остаток ТЗ:
Сделай еще одну аппку, которая будет принимать твой алерт по ресту и пока что просто логгировать и ложить в отдельную базу. можешь использовать тот же инстанс постгреса, но дуругую базу

###
и тебе понадобится сервис, которій заполняет твою табличку фейковіми данніми. Сделай чтоб он срабатівал когда по ресту дернули его и останавливается так же.
Для генерации советую использовать либку Java Faker




curl -X POST http://localhost:8081/alerts -H "Content-Type: application/json" -d '{"level":"HIGH","value":123.45,"timestamp":"2024-06-25T12:00:00"}'
